<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>G·ª≠i T√¢m S·ª±</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="wrap" aria-labelledby="pageTitle">
    <aside class="visual">
      <div class="logo">‚ô°</div>
      <h3 id="pageTitle">G·ª≠i T√¢m S·ª±</h3>
      <p>Vi·∫øt ƒëi·ªÅu b·∫°n mu·ªën n√≥i</p>
    </aside>

    <form id="confideForm" novalidate>
      <input type="hidden" id="FORM_ENDPOINT" value="https://formspree.io/f/mdkyorzy">

      <div style="position:absolute;left:-2000px;">
        <label for="hp">Kh√¥ng ƒëi·ªÅn √¥ n√†y</label>
        <input id="hp" name="hp" autocomplete="off">
      </div>

<div class="chat-box chat-preview" id="chatBox">
  <div class="chat-header">
    CHAT BOX
  </div>

  <div class="chat-messages">
    <div class="chat-message bot">
    </div>
  </div>

  <div class="chat-input">
    <input
  id="chatMessage"
  placeholder="Tr√≤ chuy·ªán b·∫•t c·ª© ƒëi·ªÅu g√¨..."
  autocomplete="off"
/>
    <button type="button" id="chatSendBtn" class="btn small">G·ª≠i</button>
  </div>
</div>




      <div>
        <label for="message">G·ª≠i ƒëi·ªÅu mu·ªën n√≥i</label>
        <textarea id="message" name="message"
          placeholder="B·∫°n c√≥ th·ªÉ k·ªÉ chuy·ªán, t√¢m s·ª±, nh·ªù t∆∞ v·∫•n..."></textarea>
      </div>

      <div class="actions">
        <label class="checkbox">
        </label>
        <button type="submit" class="btn">G·ª≠i t√¢m s·ª±</button>
        <button type="button" id="clearBtn" class="btn ghost small">X√≥a</button>
      </div>

      <div id="statusArea"></div>

      <footer>
      </footer>
    </form>
  </main>

<script>
(function(){
  const form = document.getElementById('confideForm');
  const status = document.getElementById('statusArea');
  const endpointInput = document.getElementById('FORM_ENDPOINT');
  const clearBtn = document.getElementById('clearBtn');

  const messagesBox = document.querySelector('.chat-messages');
  const chatInput = document.getElementById('chatMessage');
  const chatSendBtn = document.getElementById('chatSendBtn');

  // ===== CHAT UI =====
  function addMessage(text, type){
    if (!text) return;

    const msg = document.createElement('div');
    msg.className = 'chat-message ' + type;

    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    bubble.textContent = text;

    msg.appendChild(bubble);
    messagesBox.appendChild(msg);
    messagesBox.scrollTop = messagesBox.scrollHeight;
  }

  chatSendBtn.addEventListener('click', () => {
    const text = chatInput.value.trim();
    if (!text) return;

    addMessage(text, 'user');
    chatInput.value = '';
  });

  // ===== CLEAR =====
  clearBtn.addEventListener('click', ()=>{
    form.reset();
    status.innerHTML = '';
  });

  // ===== FORM SUBMIT =====
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();

    const message = document.getElementById('message').value.trim();
    const hp = document.getElementById('hp').value;
    if (hp) return;

    if (!message){
      status.innerHTML = '<div class="success">Vui l√≤ng nh·∫≠p n·ªôi dung.</div>';
      return;
    }

    const data = {
      message,
      sentAt: new Date().toISOString()
    };

    const endpoint = endpointInput.value;
    if (!endpoint) return;

    try{
      const res = await fetch(endpoint,{
        method:'POST',
        headers:{'Content-Type':'application/json','Accept':'application/json'},
        body: JSON.stringify(data)
      });
      if(res.ok){
        status.innerHTML = '<div class="success">G·ª≠i th√†nh c√¥ng üíó</div>';
        form.reset();
      }
    }catch(err){}
  });

})();
</script>
